syntax = "proto3";

package sessionspb;


import "google/protobuf/timestamp.proto";

option go_package = "github.com/fedotovmax/microservices-shop-protos/sessionspb";


service SessionsService {
  rpc CreateSession(CreateSessionRequest) returns (CreateSessionResponse);
  //rpc VerifyAccessToken(VerifyAccessTokenRequest) returns (VerifyAccessTokenResponse);
  rpc RefreshSession(RefreshSessionRequest) returns (CreateSessionResponse);
}


message RefreshSessionRequest {
  string refresh_token = 1; // @gotags: validate:"required"
  string user_agent = 2; // @gotags: validate:"required" example:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"
  string ip = 3; // @gotags: validate:"required" format:"ip4" example:"19.56.186.122"
}




message CreateSessionRequest {
  string uid = 1; // @gotags: validate:"required" format:"uuid"
  string user_agent = 2;  // @gotags: validate:"required" example:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"
  string ip = 3; // @gotags: validate:"required" format:"ip4" example:"19.56.186.122"
  optional string bypass_code = 4; // @gotags: validate:"optional" example:"1A2B3C4D5E6F"
  optional string device_trust_token = 5; // @gotags: validate:"optional" example:"skdjfsdfsdifsdfsdf123"
}

message CreatedTrustToken {
  string trust_token_value = 1; // @gotags: validate:"required"
  google.protobuf.Timestamp trust_token_exp_time = 2;
}

message CreateSessionResponse {
  string access_token = 1; // @gotags: validate:"required"
  string refresh_token = 2; // @gotags: validate:"required"
  google.protobuf.Timestamp access_exp_time = 3; // @gotags: validate:"required"
  google.protobuf.Timestamp refresh_exp_time = 4; // @gotags: validate:"required"
  optional CreatedTrustToken trust_token = 5; // @gotags: validate:"optional"
}